# Market Data Service Integration Environment Variables
# This file contains configuration for the integrated market data service + gateway setup

# =============================================================================
# Service Configuration
# =============================================================================

# Gateway Service
PORT=8081
SANDBOX_TRADING=0
DISABLE_AUTH=1
ENVIRONMENT=integration

# Market Data Service
MARKET_SERVICE_MODE=high-performance
MARKET_SERVICE_PORT=8080
MARKET_SERVICE_BIND_ADDRESS=0.0.0.0

# =============================================================================
# NATS JetStream Configuration
# =============================================================================

# NATS Connection
NATS_URL=nats://localhost:4222
NATS_CLUSTER_ID=trading-cluster
NATS_CLIENT_ID=gateway-service

# Event Bridge Configuration
ENABLE_MARKET_DATA_BRIDGE=true
MARKET_SERVICE_STREAM=MARKET_DATA
BRIDGE_CONSUMER_NAME=gateway-market-bridge
BRIDGE_BATCH_SIZE=100
BRIDGE_TIMEOUT_MS=5000
BRIDGE_MAX_RECONNECT=10
BRIDGE_ENABLE_METRICS=true

# =============================================================================
# Service Dependencies
# =============================================================================

# Market Data Service Health Check
MARKET_DATA_SERVICE_URL=http://localhost:8080/health

# Database (Optional for integration testing)
DATABASE_URL=postgresql://postgres:password@localhost:5432/trading_db
DATABASE_MAX_CONNECTIONS=10
DATABASE_MIN_CONNECTIONS=2

# Redis (Optional for caching)
REDIS_URL=redis://localhost:6379
REDIS_POOL_SIZE=10

# =============================================================================
# Integration Features
# =============================================================================

# WebSocket Configuration  
USE_SHARDED_WEBSOCKET=true
WS_MAX_CONNECTIONS=1000
WS_HEARTBEAT_INTERVAL_SECS=30

# Circuit Breaker
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT_SECS=60

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=1000

# =============================================================================
# Exchange Configuration (for Market Data Service)
# =============================================================================

# Binance Configuration
BINANCE_API_KEY=
BINANCE_SECRET_KEY=
BINANCE_TESTNET=true
BINANCE_BASE_URL=https://testnet.binance.vision
BINANCE_WS_URL=wss://testnet-dstream.binance.vision/ws

# OKX Configuration (disabled by default)
OKX_API_KEY=
OKX_SECRET_KEY=
OKX_PASSPHRASE=
OKX_TESTNET=true
OKX_BASE_URL=https://www.okx.com
OKX_WS_URL=wss://ws.okx.com:8443/ws/v5/public

# Enabled Exchanges
ENABLED_EXCHANGES=binance

# =============================================================================
# Trading Pairs
# =============================================================================

# Default trading pairs for market data
TRADING_PAIRS=BTCUSDT,ETHUSDT,ADAUSDT,DOTUSDT,LINKUSDT

# =============================================================================
# Performance Configuration
# =============================================================================

# HTTP Client Timeouts
HTTP_REQUEST_TIMEOUT_SECS=30
HTTP_CONNECT_TIMEOUT_SECS=10

# gRPC Configuration
GRPC_CONNECT_TIMEOUT_SECS=5
GRPC_REQUEST_TIMEOUT_SECS=30
GRPC_CONCURRENCY_LIMIT=256

# Logging
RUST_LOG=info,gateway_service=debug,market_service=debug
LOG_FORMAT=json
LOG_LEVEL=info

# =============================================================================
# Monitoring and Metrics
# =============================================================================

# Enable metrics collection
ENABLE_METRICS=true
METRICS_INTERVAL_SECONDS=10

# Health check intervals
HEALTH_CHECK_INTERVAL_SECONDS=30
STARTUP_TIMEOUT_SECONDS=120
DEPENDENCY_CHECK_PARALLEL=true